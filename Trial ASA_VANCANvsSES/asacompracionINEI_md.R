#setwd("~/Spatial-surveillance/Spatial_information_from_Arequipa2020/Manzanas _Arequipa/ASA//")

# upload packages
library(readxl)
library(rgeos)
library(geosphere)
library(rgdal)
library(rworldmap)
library(tidyr)
library(Stack)
library(SearchTrees)
library(data.table)
library(raster)
library(dplyr)
library(plyr)
#install.packages("tmap")
library(tmap)
library(ggmap)
library(maps)
library(GISTools)
library(ggmap)
library(maptools)
library(Cairo)
library(scales)
library(RColorBrewer)
library(spData) # example datasets
library(sp)
library(sf)
library(stringr)
library(rvest)
library(dbplyr)
library(tidyverse)
library(ggplot2)


layers<-st_layers("Alto Selva Alegre_Mz.kml")


layerslist <- list()
cnt <- 1
for (i in c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16","17","19","21","23","24","25","26","27","28","29","30","31","32","33","34",
             "35", "36", "37", "38","39", "40", "41", "42", "43","44", "45", "46","47","48","49","50","57","58","60","61","63","67",
            "69","70","71","73","74","75","76","77","78","79", "80", "81","82", "83", "84", "85", "86","87", "88", "94", "95", "97","98", "99", "100","102")) {
  # load file
  layer.i <- switch(i
                    ,"1"="1.-Alto Selva Alegre Zona A"    
                    ,"2"="2.-Alto Selva Alegre Zona B"    
                    ,"3"="3.-Alto Selva Alegre Zona C"    
                    ,"4"="4.-Urb._Graficos"    
                    ,"5"="5.-Andres Avelino Caceres"   
                    ,"6"="6.-Coop. La Estrella"   
                    ,"7" ="7.-Asoc.de Viv.Antonio Jose de Sucre"    
                    ,"8" ="8.-San Jose"   
                    ,"9" ="9.-Coop. Viv. Villa el Sol P. Polanco"    
                    ,"10"="10.-UPIS Ramiro Priale"    
                    ,"11"="11.-Coop. Artesanal Aproma Pampas Polanco"
                    ,"12"="12.-Asoc.Viv. J. V. Alvarado"    
                    ,"13"= "13.-Asoc. Viv. Villa el Mirador P. Polanco"
                    ,"14"="14.-A.A.H.H. Javier Heraud Pampas Polanco"
                    ,"16"="16.-Asoc. de Vivienda Villa Arequipa"    
                    ,"17"="17.-Agusto Salazar Bondy"    
                    ,"19"="19.-Egasa Zona Rural"    
                    ,"21"="21.-Avis Cruce de Chilina"    
                    ,"23"="23.-Avis. Villa el Conquistador II"  
                    ,"24"="24.-Coop. de Viv. Vista Alegre Luis G. S."
                    ,"25"="25.-Coop. de Viv. Enatru"
                    ,"26"="26.-Coop. Cruce Chilina"    
                    ,"27"="27.-Coop. de Viv. los Eucaliptos"    
                    ,"28"="28.-Avis Rafael Hoyo Rubio"    
                    ,"29"= "29.-Asoc. Artesanal el Misti"    
                    ,"30"="30.-Avis Nestor Caceres Velasquez II"    
                    ,"31"="31.-Complejo Artesanal"   
                    ,"32"="32.-Avis Nestor C. Velasquez I"
                    ,"33"="33.-Ampliacion Apurimac"    
                    ,"34"="34.-Urb Apurimac"   
                    ,"35"="35.-AVIS 14 de Agosto"    
                    #,"36"="36.-Asociaci贸n Villa Vitarte y San Hilarion"
                    ,"36"="36.-Asociacin Villa Vitarte y San Hilarion"
                    ,"37"="37.-AVIS Garcilazo de la Vega"    
                    ,"38"="38.-AVIS Leones del Misti"    
                    #,"39"="39.-Ampliaci贸n Villa Union" 
                    ,"39"="39.-Ampliacin Villa Union" 
                    ,"40"="40.-Villa Union"   
                    ,"41" ="41.-AA. HH. Nueva Esperanza, San Luis"    
                    ,"42" ="42.-UPIS San Luis"   
                    ,"43" ="43.-AVIS Virgen de Chapi"    
                    #,"44"="44.-Habitacion Urbana Progresiva Se帽or de los Piedades"
                    ,"44"="44.-Habitacion Urbana Progresiva Seor de los Piedades"  
                    ,"45"="45.-Granjeros San Lazaro"
                    ,"46"="46.-Avis Mirador II"    
                    ,"47"= "47.-AAHH Bella Esperanza"
                    ,"48"="48.-Avis Javier Heraud parte alta"
                    ,"49"="49.-AAHH Amp. Javier Heraud"    
                    ,"50"="50.-AVIS Las Rocas"    
                    ,"57"="57.-Programa Municipal 1 Zona B"    
                    ,"58"="58.-Avis Los 3 Balcones del Misti"    
                    ,"60"="60.-Mirador Zona B"    
                    ,"61"="61.-Asociacion de vivienda Las Rocas del Mirador"    
                    ,"63"="63.-Chavin de Huantar"
                    ,"67"="67.-ASVIT El Huarangal B"
                    ,"69"="69.-Mirador Zeta 33"    
                    #,"70"="70.-Villa Asunci贸n"    
                    ,"70"="70.-Villa Asuncin"    
                    ,"71"="71.-Villa Chachas"    
                    ,"73"= "73.-Lealtad Democratica"    
                    ,"74"="74.-Independencia Zona B"    
                    ,"75"="75.-Villa Independiente Zona A"   
                    ,"76"="76.-Villa Independiente Zona B"
                    ,"77"="77.-AA. HH. Primero de Enero"    
                    ,"78"="78.-Independencia Zona A I" 
                    ,"79"="79.-Independencia Zona A-II.kmz"    
                    ,"80"="80.-Villa San Pablo.kmz"    
                    ,"81"="81.-Villa Florida"    
                    ,"82"="82.-Pampa Chica"    
                    ,"83"="83.-Villa Salvador"  
                    ,"84"="84.-Asoc. Pro Vivienda San Lazaro"
                    ,"85"="85.-Andes del Misti"
                    ,"86"="86.-Balcones de Chilina"    
                    ,"87"="87.-Villa Confraternidad A-I"    
                    ,"88"="88.-Villa Confraternidad A-II"    
                    ,"94"= "94.-Villa Confraternidad B-II"    
                    ,"95"="95.-Villa Confraternidad Zona B III Margen Derecho"    
                    ,"97"="97.-Villa Ecologica Zona C I Margen Derecho"   
                    ,"98"="98.-Villa Ecologica Zona C II Margen Izquierda"
                    ,"99"="99.-Villa Ecologica Zona D-1"    
                    ,"100"="100.-Villa Ecologica Zona D-2 Margen Derecho"
                    ,"102"="102.-Villa Ecologica Zona E-2 Margen Izquierda")   
  
  asalayer<-st_read("Alto Selva Alegre_Mz.kml",layer.i)
  layerslist[[cnt]] <- asalayer
  cnt <- cnt + 1
}
layer <- do.call(rbind, layerslist)
plot(layer)

centroid <- st_centroid(layer)

plot(st_geometry(layer))
plot(centroid, add = T, col = 'red', pch = 18)
fortify(centroid)
class(centroid)

########Leyendo las casas y juntando con asa ####### encuestas rabia  

merge_mz<-read.csv("C:/Users/Cayetano/Rabies/rabia_ASA_encuesta_2016/asa_gps_rociado.csv")
merge_mz<-merge_mz[,c(1:8)]

encuesta_mz<-read.csv("C:/Users/Cayetano/Rabies/rabia_ASA_encuesta_2016/resultados/houses_data.csv")
encuesta_mz<-encuesta_mz[,c(2,48)]


todo_mz<-merge(merge_mz,encuesta_mz, by="UNICODE", all.y=TRUE)
todo_mz<-unique(todo_mz)
todo_mz <- todo_mz[!(is.na(todo_mz$LATITUDE)),]

todo_mz=dplyr::mutate(todo_mz,code=paste(P,D,L,sep = "."))
todo_mz=dplyr::mutate(todo_mz,Name=paste(code,block,sep = "-"))

todo_mz_agregado<-aggregate(VIVEN_TOTAL~ Name,data = todo_mz,FUN = sum)
todo_mz_agregado$Name<-factor(todo_mz_agregado$Name)
levels(todo_mz_agregado$Name)

centroidmzasa<-merge(centroid,todo_mz_agregado,by="Name",all.y=TRUE)
plot(st_geometry(layer))
plot(st_geometry(centroidmzasa))



############# COMPARACION INEI DATA ###############
###################################################



data_mz <- readOGR("C:/Users/Cayetano/Spatial-surveillance/INEI_information_by_block/Mapa/Mz_PrincipalesCiudades.shp", 
                   "Mz_PrincipalesCiudades") 

data_asa<-subset(data_mz,NOMBDIST == "ALTO SELVA ALEGRE")
plot(data_asa)

library(rgdal)
head(data_asa@data)
data_asa$NOMCCPP <- factor(data_asa$NOMCCPP)
levels(data_asa$NOMCCPP) # "CAYMA"
levels(data_asa$CODZONA)
levels(data_asa$SUFZONA)

INEIDATA <- readOGR("C:/Users/Cayetano//Spatial-surveillance/INEI_information_by_block/Mapa/Mz_PrincipalesCiudades.shp", 
                    "Mz_PrincipalesCiudades") 
INEIDATA<-subset(INEIDATA,NOMBDIST == "ALTO SELVA ALEGRE")

plot(INEIDATA)

data_pob <- read_xlsx("C:/Users/Cayetano//Spatial-surveillance/INEI_information_by_block/Dato/Poblacion_1.xlsx") # old
data_pob <- data_pob[,c(1:10,22:30)] 
data_pob<-data_pob%>% filter(`Nombre de Distrito`=="ALTO SELVA ALEGRE")


data_completo <- merge(INEIDATA, data_pob, 
                       by.x="IDMANZANA", by.y="Idmanzana", all.x=T, all.y=F)
plot(data_completo)

png(filename="comparacionmd.png", width=1100, height=600)
ggplot() +
  geom_sf(data = data_completo, aes(fill="Poblacin Total"))+
  geom_sf_text(data = centroidmzasa, aes(geometry,label = "VIVEN_TOTAL"),size=1.2, colour = "RED")
dev.off()

INEIDATAdf <- INEIDATA@data 


sum(is.na(data_completo$`Poblaci贸n Total`))
#[1] 1153
sum(!is.na(data_completo$`Seg煤n sexo Mujer`))
#[1] 876

hist(data_completo$`Poblaci贸n Total`)
tmp1_map <- data_completo
tmp1_map@data$`Poblaci贸n Total`[is.na(tmp1_map@data$`Poblaci贸n Total`)]<-NA

png(filename="INEI_ASA_POBLACION.png", width=1100, height=600)
qtm(tmp1_map, fill = 'Poblaci贸n Total', fill.palette="Blues",
    fill.title="Poblacion")
dev.off()








# # #START##
# # #reading in kml as text 
# # kml.text <- readLines(mmlayer)
# # 
# # #this pulls all with tags - primary code
# # ID_pattern <- "-[[:digit:]]{2}\\.[[:digit:]]{14,}" ####WOOOOOOOO 
# # kml_coords <- grep(ID_pattern, kml.text, value = TRUE) 
# # 
# # #extracting only the poly - which is row (or element) 
# # poly <- kml_coords #seems to be pulling all 
# # 
# # #cleaning and extracting only the coordinates of the outer polygon file
# # poly_coords <- poly %>%
# #   str_remove_all("0 ") %>% #removing 0 and space - may want to keep later as this is the elevation layer
# #   str_remove_all("0") %>% #removeing trailing 0 
# #   str_remove_all("\\t") %>% 
# #   str_remove_all("</>") %>% 
# #   str_remove_all("[:space:]") %>%
# #   str_split(",") #creating a comma deliminator
# # 
# # #getting rid of blank element in list
# # poly_coords <- lapply(poly_coords, function(x) x[!x %in% ""])
# # 
# # #unlisting to make it a single object  
# # poly_coords <- as.numeric(unlist(poly_coords))
# # poly_coords <- na.omit(poly_coords)
# # 
# # #creating a matrix of outer polygon points 
# # #csv if you need it 
# # out_poly <- matrix(poly_coords, ncol = 2, byrow = TRUE)
# # out_poly<-as.data.frame(out_poly)
# # colnames(out_poly)[colnames(out_poly)=="V1"] <- "LONGITUDE"
# # colnames(out_poly)[colnames(out_poly)=="V2"] <- "LATITUDE"
# # 
# # 
# # out_poly.coor<-out_poly[,c("LONGITUDE","LATITUDE")]
# # #"interpretando" las variables longitude y latitude como coordenadas geograficas
# # coordinates(out_poly.coor) <- ~LONGITUDE+LATITUDE
# # # # Proyectando las coordenadas (planas en 2D) sobre la curvatura tierra
# #    proj4string(out_poly.coor) <- CRS("+proj=longlat +datum=WGS84") 
# # # # Transformando coordenadas decimales (grados) a coordenadas UTM (en metros)
# # xy <- spTransform(out_poly.coor, CRS("+proj=utm +zone=19 +south=T ellps=5389"))
# # # 
# # # #Convertir a data.frame para poder hacer el cbind
# # xy <- as.data.frame(xy)
# # # 
# # # #Cambiando nombres de columnas
# #  colnames(xy)<-c("long_UTM","lat_UTM")
# # # 
# # # #Juntando columnas
# #  out_poly_utm<- cbind(out_poly, xy)
# # # 
# # utm18nCRS<-st_crs(out_poly.coor)
# # plot_locations_sp_rociado <- st_as_sf(out_poly_utm, coords = c("long_UTM","lat_UTM"), crs = utm18nCRS)
# # class(plot_locations_sp_rociado)
# # 
# # zpts_poly <- list(out_poly)
# # 
# 
# ## getting utm projection and ccoordinates ####
# #extracted geometries from  
# centroid <- st_centroid(mmlayer)
# 
# plot(st_geometry(mmlayer))
# plot(centroid, add = T, col = 'red', pch = 18)
# 
# 
# fortify(centroid)
# class(centroid)
# spray<-read.csv("~/PETM-shiny/PRUEBAS_MODEL/prev_spray_block.csv")
# class(spray)
# colnames(spray)[colnames(spray)=="block"] <- "Name"
# 
# aux<-merge(spray,centroid,by="Name")
# 
# write.csv(aux,"~/PETM-shiny/PRUEBAS_MODEL/auxcentroides.csv",row.names = FALSE)
# 
# # #calculating distances between centroids
# # m <- st_distance(centroid, centroid)
# # fortify(m)
# # write.csv(m,"~/PETM-shiny/PRUEBAS_MODEL/matrixmm.csv",row.names = FALSE)
# 
# 
# # a = data.frame(a = 1:3, b = 5:7)
# # st_geometry(a) = st_sfc(st_point(c(0,0)), st_point(c(1,1)), st_point(c(2,2)))
# # b = data.frame(x = c("a", "b", "c"), b = c(2,5,6))
# # merge(a, b)
# b<-st_distance(aux$geometry,aux$geometry)
# write.csv(b,"~/PETM-shiny/PRUEBAS_MODEL/MATRIXAUX.csv",row.names = FALSE)
# class(aux)
# df<-read.csv("~/PETM-shiny/PRUEBAS_MODEL/MATRIXAUX.csv")
# library(dplyr)
# 
# 
# newnames= c('1.10.10-1','1.10.10-10', '1.10.10-11', '1.10.10-12','1.10.10-13','1.10.10-14','1.10.10-2','1.10.10-3', 
#             '1.10.10-4','1.10.10-5','1.10.10-6','1.10.10-7','1.10.10-8','1.10.10-9','1.10.11-1','1.10.11-10',
#             '1.10.11-11','1.10.11-2','1.10.11-3','1.10.11-4','1.10.11-5','1.10.11-6','1.10.11-7','1.10.11-8', 
#             '1.10.11-9','1.10.12-1','1.10.12-10','1.10.12-11','1.10.12-12','1.10.12-13','1.10.12-14','1.10.12-15',
#             '1.10.12-16','1.10.12-2','1.10.12-3','1.10.12-4','1.10.12-5','1.10.12-6','1.10.12-7','1.10.12-8', 
#             '1.10.12-9','1.10.13-1','1.10.13-10','1.10.13-11','1.10.13-12','1.10.13-13','1.10.13-14','1.10.13-15',
#             '1.10.13-16','1.10.13-17','1.10.13-18','1.10.13-19','1.10.13-2','1.10.13-20','1.10.13-21','1.10.13-22',
#             '1.10.13-23','1.10.13-24','1.10.13-25','1.10.13-26','1.10.13-27','1.10.13-3','1.10.13-5','1.10.13-6', 
#             '1.10.13-7','1.10.13-8','1.10.13-9','1.10.15-1','1.10.15-10','1.10.15-11','1.10.15-12','1.10.15-13',
#             '1.10.15-14','1.10.15-15','1.10.15-16','1.10.15-17','1.10.15-18','1.10.15-2','1.10.15-3','1.10.15-4', 
#             '1.10.15-5','1.10.15-6','1.10.15-7','1.10.15-8','1.10.15-9','1.10.16-1','1.10.16-10','1.10.16-11',
#             '1.10.16-12', '1.10.16-13','1.10.16-15','1.10.16-2','1.10.16-3','1.10.16-4','1.10.16-5','1.10.16-6', 
#             '1.10.16-7','1.10.16-8','1.10.16-9','1.10.2-1','1.10.2-10','1.10.2-100','1.10.2-101','1.10.2-102',
#             '1.10.2-103','1.10.2-104','1.10.2-105','1.10.2-106','1.10.2-107','1.10.2-11','1.10.2-12','1.10.2-13', 
#             '1.10.2-14','1.10.2-15','1.10.2-16','1.10.2-17','1.10.2-18','1.10.2-19','1.10.2-2','1.10.2-20', 
#             '1.10.2-21','1.10.2-22','1.10.2-23','1.10.2-24','1.10.2-25','1.10.2-26','1.10.2-27','1.10.2-28', 
#             '1.10.2-29','1.10.2-3','1.10.2-30','1.10.2-31','1.10.2-32','1.10.2-33','1.10.2-34','1.10.2-35', 
#             '1.10.2-36','1.10.2-37','1.10.2-38',',1.10.2-39','1.10.2-40','1.10.2-41','1.10.2-42','1.10.2-43', 
#             '1.10.2-44','1.10.2-45','1.10.2-46','1.10.2-47','1.10.2-48','1.10.2-49','1.10.2-5','1.10.2-50', 
#             '1.10.2-51','1.10.2-52','1.10.2-53','1.10.2-54','1.10.2-55','1.10.2-56','1.10.2-57','1.10.2-58', 
#             '1.10.2-59','1.10.2-60','1.10.2-61','1.10.2-62','1.10.2-63','1.10.2-64','1.10.2-65','1.10.2-66', 
#             '1.10.2-67','1.10.2-68','1.10.2-69','1.10.2-7','1.10.2-70','1.10.2-71','1.10.2-72','1.10.2-73', 
#             '1.10.2-74','1.10.2-75','1.10.2-76','1.10.2-77','1.10.2-78','1.10.2-79','1.10.2-8','1.10.2-80', 
#             '1.10.2-81','1.10.2-82','1.10.2-83','1.10.2-84','1.10.2-85','1.10.2-86','1.10.2-87','1.10.2-88', 
#             '1.10.2-89','1.10.2-9','1.10.2-90','1.10.2-91','1.10.2-92','1.10.2-93','1.10.2-94','1.10.2-95', 
#             '1.10.2-96','1.10.2-97','1.10.2-98','1.10.2-99','1.10.28-1','1.10.28-2','1.10.28-3','1.10.28-4', 
#             '1.10.3-1','1.10.3-10','1.10.3-11','1.10.3-12','1.10.3-2','1.10.3-3','1.10.3-4','1.10.3-5',  
#             '1.10.3-6','1.10.3-7','1.10.3-8','1.10.3-9','1.10.36-1','1.10.36-10','1.10.36-11','1.10.36-12',
#             '1.10.36-13','1.10.36-14','1.10.36-15','1.10.36-16','1.10.36-17','1.10.36-18','1.10.36-19','1.10.36-2', 
#             '1.10.36-20','1.10.36-21','1.10.36-22;','1.10.36-23','1.10.36-24','1.10.36-25','1.10.36-26','1.10.36-27',
#             '1.10.36-28','1.10.36-29','1.10.36-3','1.10.36-30','1.10.36-31','1.10.36-32','1.10.36-33','1.10.36-34',
#             '1.10.36-35','1.10.36-36','1.10.36-37','1.10.36-38','1.10.36-39','1.10.36-4','1.10.36-40','1.10.36-41',
#             '1.10.36-42','1.10.36-43','1.10.36-44','1.10.36-45','1.10.36-46','1.10.36-47','1.10.36-5','1.10.36-6',
#             '1.10.36-7','1.10.36-8','1.10.36-9','1.10.37-1','1.10.37-10','1.10.37-11','1.10.37-12','1.10.37-13',
#             '1.10.37-14','1.10.37-15','1.10.37-16','1.10.37-17','1.10.37-18','1.10.37-19','1.10.37-2','1.10.37-20',
#             '1.10.37-21','1.10.37-22','1.10.37-23','1.10.37-24','1.10.37-25','1.10.37-26','1.10.37-27','1.10.37-28',
#             '1.10.37-29','1.10.37-3 ','1.10.37-30','1.10.37-31','1.10.37-33','1.10.37-34','1.10.37-35','1.10.37-36',
#             '1.10.37-37','1.10.37-38','1.10.37-39','1.10.37-4','1.10.37-40','1.10.37-41','1.10.37-42','1.10.37-43',
#             '1.10.37-44','1.10.37-45','1.10.37-46','1.10.37-47','1.10.37-48','1.10.37-49','1.10.37-5','1.10.37-50',
#             '1.10.37-51','1.10.37-52','1.10.37-53','1.10.37-54','1.10.37-55','1.10.37-56','1.10.37-57','1.10.37-58',
#             '1.10.37-59','1.10.37-6','1.10.37-60','1.10.37-61','1.10.37-62','1.10.37-63','1.10.37-64','1.10.37-65',
#             '1.10.37-66','1.10.37-67','1.10.37-68','1.10.37-69','1.10.37-7','1.10.37-70','1.10.37-71','1.10.37-72',
#             '1.10.37-73','1.10.37-74','1.10.37-75','1.10.37-76','1.10.37-77','1.10.37-78','1.10.37-79','1.10.37-8', 
#             '1.10.37-80','1.10.37-81','1.10.37-82','1.10.37-83','1.10.37-84','1.10.37-85','1.10.37-86','1.10.37-87',
#             '1.10.37-88','1.10.37-89','1.10.37-9','1.10.37-90','1.10.37-91','1.10.37-92','1.10.38-1','1.10.38-10',
#             '1.10.38-11','1.10.38-12','1.10.38-13','1.10.38-14','1.10.38-15','1.10.38-16','1.10.38-17','1.10.38-18',
#             '1.10.38-19','1.10.38-2','1.10.38-20','1.10.38-21','1.10.38-22','1.10.38-23','1.10.38-24','1.10.38-25',
#             '1.10.38-26','1.10.38-27','1.10.38-28','1.10.38-29','1.10.38-3','1.10.38-30','1.10.38-31','1.10.38-32',
#             '1.10.38-33','1.10.38-34','1.10.38-35','1.10.38-36','1.10.38-37','1.10.38-38','1.10.38-39','1.10.38-4', 
#             '1.10.38-40','1.10.38-41','1.10.38-42','1.10.38-43','1.10.38-44','1.10.38-45','1.10.38-46','.10.38-47',
#             '1.10.38-48','1.10.38-49','1.10.38-5','1.10.38-50','1.10.38-51','1.10.38-52','1.10.38-53','1.10.38-54',
#             '1.10.38-55','1.10.38-56','1.10.38-57','1.10.38-58','1.10.38-59','1.10.38-6','1.10.38-60','1.10.38-61',
#             '1.10.38-62','1.10.38-63','1.10.38-64','1.10.38-65','1.10.38-66','1.10.38-67','1.10.38-68','1.10.38-69',
#             '1.10.38-7','1.10.38-70','1.10.38-71','1.10.38-72','1.10.38-73','1.10.38-74','1.10.38-8','1.10.38-9', 
#             '1.10.9-1','1.10.9-3','1.10.9-4','1.10.9-5','1.10.9-6') 
# 
# 
# oldnames= c("V1","V2","V3","V4","V5","V6","V7","V8","V9","V10","V11","V12","V13","V14",  
#             "V15","V16","V17","V18","V19","V20","V21","V22","V23","V24","V25","V26","V27",
#             "V28","V29","V30","V31","V32","V33","V34","V35","V36","V37","V38","V39", 
#             "V40","V41","V42","V43","V44","V45","V46","V47","V48","V49","V50","V51","V52", 
#             "V53","V54","V55","V56","V57","V58","V59","V60","V61","V62","V63","V64","V65", 
#             "V66","V67","V68","V69","V70","V71","V72","V73","V74","V75","V76","V77","V78", 
#             "V79","V80","V81","V82","V83","V84","V85","V86","V87","V88","V89","V90","V91", 
#             "V92","V93","V94","V95","V96","V97","V98","V99","V100","V101","V102","V103","V104",
#             "V105","V106","V107","V108","V109","V110","V111","V112","V113","V114","V115","V116","V117",
#             "V118","V119","V120","V121","V122","V123","V124","V125","V126","V127","V128","V129","V130",
#             "V131","V132","V133","V134","V135","V136","V137","V138","V139","V140","V141","V142","V143",
#             "V144","V145","V146","V147","V148","V149","V150","V151","V152","V153","V154","V155","V156",
#             "V157","V158","V159","V160","V161","V162","V163","V164","V165","V166","V167","V168","V169",
#             "V170","V171","V172","V173","V174","V175","V176","V177","V178","V179","V180","V181","V182",
#             "V183","V184","V185","V186","V187","V188","V189","V190","V191","V192","V193","V194","V195",
#             "V196","V197","V198","V199","V200","V201","V202","V203","V204","V205","V206","V207","V208",
#             "V209","V210","V211","V212","V213","V214","V215","V216","V217","V218","V219","V220","V221",
#             "V222","V223","V224","V225","V226","V227","V228","V229","V230","V231","V232","V233","V234",
#             "V235","V236","V237","V238","V239","V240","V241","V242","V243","V244","V245","V246","V247",
#             "V248","V249","V250","V251","V252","V253","V254","V255","V256","V257","V258","V259","V260",
#             "V261","V262","V263","V264","V265","V266","V267","V268","V269","V270","V271","V272","V273",
#             "V274","V275","V276","V277","V278","V279","V280","V281","V282","V283","V284","V285","V286",
#             "V287","V288","V289","V290","V291","V292","V293","V294","V295","V296","V297","V298","V299",
#             "V300","V301","V302","V303","V304","V305","V306","V307","V308","V309","V310","V311","V312",
#             "V313","V314","V315","V316","V317","V318","V319","V320","V321","V322","V323","V324","V325",
#             "V326","V327","V328","V329","V330","V331","V332","V333","V334","V335","V336","V337","V338",
#             "V339","V340","V341","V342","V343","V344","V345","V346","V347","V348","V349","V350","V351",
#             "V352","V353","V354","V355","V356","V357","V358","V359","V360","V361","V362","V363","V364",
#             "V365","V366","V367","V368","V369","V370","V371","V372","V373","V374","V375","V376","V377",
#             "V378","V379","V380","V381","V382","V383","V384","V385","V386","V387","V388","V389","V390",
#             "V391","V392","V393","V394","V395","V396","V397","V398","V399","V400","V401","V402","V403",
#             "V404","V405","V406","V407","V408","V409","V410","V411","V412","V413","V414","V415","V416",
#             "V417","V418","V419","V420","V421","V422","V423","V424","V425","V426","V427","V428","V429",
#             "V430","V431","V432","V433","V434","V435","V436","V437")
# df<-df %>% rename_at(vars(oldnames), ~ newnames)
# write.csv(df,"~/PETM-shiny/PRUEBAS_MODEL/matrix_spray.csv",row.names = FALSE)
# 
# ##### encuestas ######
# st_geometry(centroid)
# survey<-read.csv("~/PETM-shiny/PRUEBAS_MODEL/prev_survey_block.csv")
# class(survey)
# colnames(survey)[colnames(survey)=="block"] <- "Name"
# 
# survey<-merge(survey,centroid,by="Name")
# c<-st_distance(survey$geometry,survey$geometry)
# write.csv(c,"~/PETM-shiny/PRUEBAS_MODEL/MATRISURVEY.csv",row.names = FALSE)
# df<-read.csv("~/PETM-shiny/PRUEBAS_MODEL/MATRISURVEY.csv")
# 
# 
# newnames<-c('1.10.1-1','1.10.1-10','1.10.1-11','1.10.1-12','1.10.1-13','1.10.1-14','1.10.1-15','1.10.1-16', 
#             '1.10.1-17','1.10.1-2','1.10.1-3','1.10.1-4','1.10.1-5','1.10.1-6','1.10.1-7','1.10.1-8',  
#             '1.10.1-9','1.10.10-1','1.10.10-10','1.10.10-11','1.10.10-12','1.10.10-13','1.10.10-14','1.10.10-2', 
#             '1.10.10-3','1.10.10-4','1.10.10-5','1.10.10-6','1.10.10-7','1.10.10-8','1.10.10-9','1.10.11-1', 
#             '1.10.11-10','1.10.11-11','1.10.11-2','1.10.11-3','1.10.11-4','1.10.11-5','1.10.11-6','1.10.11-7', 
#             '1.10.11-8','1.10.11-9','1.10.12-1','1.10.12-10','1.10.12-11','1.10.12-12','1.10.12-13','1.10.12-14',
#             '1.10.12-15','1.10.12-16','1.10.12-2','1.10.12-3','1.10.12-4','1.10.12-5','1.10.12-6','1.10.12-7',
#             '1.10.12-8','1.10.12-91','10.13-1','1.10.13-10','1.10.13-11','1.10.13-12','1.10.13-13','1.10.13-14',
#             '1.10.13-15','1.10.13-16','1.10.13-17','1.10.13-18','1.10.13-19','1.10.13-2','1.10.13-20','1.10.13-21',
#             '1.10.13-22','1.10.13-23','1.10.13-24','1.10.13-25','1.10.13-26','1.10.13-27','1.10.13-3','1.10.13-5', 
#             '1.10.13-6','1.10.13-7','1.10.13-8','1.10.13-9','1.10.14-1','1.10.14-10','1.10.14-11','1.10.14-12',
#             '1.10.14-13','1.10.14-14','1.10.14-15','1.10.14-16','1.10.14-2','1.10.14-3','1.10.14-4','1.10.14-4', 
#             '1.10.14-5','1.10.14-6','1.10.14-7','1.10.14-8','1.10.14-9','1.10.15-1','1.10.15-10','1.10.15-11',
#             '1.10.15-12','1.10.15-13','1.10.15-14','1.10.15-15','1.10.15-16','1.10.15-17','1.10.15-18','1.10.15-2', 
#             '1.10.15-3','1.10.15-4','1.10.15-5','1.10.15-6','1.10.15-7','1.10.15-8','1.10.15-9','1.10.16-1',
#             '1.10.16-10','1.10.16-11','1.10.16-12','1.10.16-13','1.10.16-15','1.10.16-2','1.10.16-3','1.10.16-4',
#             '1.10.16-5','1.10.16-6','1.10.16-7','1.10.16-8','1.10.16-9','1.10.17-1','1.10.17-10','1.10.17-11',
#             '1.10.17-12','1.10.17-13','1.10.17-14','1.10.17-2','1.10.17-3','1.10.17-4','1.10.17-5','1.10.17-6', 
#             '1.10.17-7','1.10.17-8','1.10.17-9','1.10.18-1','1.10.18-10','1.10.18-11','1.10.18-12','1.10.18-13',
#             '1.10.18-14','1.10.18-15','1.10.18-16','1.10.18-2','1.10.18-3','1.10.18-4','1.10.18-5','1.10.18-6', 
#             '1.10.18-7','1.10.18-8','1.10.18-9','1.10.19-1','1.10.19-10','1.10.19-11','1.10.19-12','1.10.19-13',
#             '1.10.19-14','1.10.19-15','1.10.19-16','1.10.19-17','1.10.19-18','1.10.19-2','1.10.19-3','1.10.19-4',
#             '1.10.19-5','1.10.19-6','1.10.19-7','1.10.19-8','1.10.19-9','1.10.2-1','1.10.2-10','1.10.2-100',
#             '1.10.2-101','1.10.2-102','1.10.2-103','1.10.2-104','1.10.2-105','1.10.2-106','1.10.2-107','1.10.2-11', 
#             '1.10.2-12','1.10.2-13','1.10.2-14','1.10.2-15','1.10.2-16','1.10.2-17','1.10.2-18','1.10.2-19', 
#             '1.10.2-2','1.10.2-20','1.10.2-21','1.10.2-22','1.10.2-23','1.10.2-24','1.10.2-25','1.10.2-26', 
#             '1.10.2-27','1.10.2-28','1.10.2-29','1.10.2-3','1.10.2-30','1.10.2-31','1.10.2-32','1.10.2-33', 
#             '1.10.2-34','1.10.2-35','1.10.2-36','1.10.2-37','1.10.2-38','1.10.2-39','1.10.2-40','1.10.2-41', 
#             '1.10.2-42','1.10.2-43','1.10.2-44','1.10.2-45','1.10.2-46','1.10.2-47','1.10.2-48','1.10.2-49',
#             '1.10.2-5','1.10.2-50','1.10.2-51','1.10.2-52','1.10.2-53','1.10.2-54','1.10.2-55','1.10.2-56', 
#             '1.10.2-57','1.10.2-58','1.10.2-59','1.10.2-60','1.10.2-61','1.10.2-62','1.10.2-63','1.10.2-64', 
#             '1.10.2-65','1.10.2-66','1.10.2-67','1.10.2-68','1.10.2-69','1.10.2-7','1.10.2-70','1.10.2-71', 
#             '1.10.2-72','1.10.2-73','1.10.2-74','1.10.2-75','1.10.2-76','1.10.2-77','1.10.2-78','1.10.2-79', 
#             '1.10.2-8','1.10.2-80','1.10.2-81','1.10.2-82','1.10.2-83','1.10.2-84','1.10.2-85','1.10.2-86', 
#             '1.10.2-87','1.10.2-88','1.10.2-89','1.10.2-9','1.10.2-90','1.10.2-91','1.10.2-92','1.10.2-93', 
#             '1.10.2-94','1.10.2-95','1.10.2-96','1.10.2-97','1.10.2-98','1.10.2-99','1.10.21-1','1.10.21-10',
#             '1.10.21-11','1.10.21-12','1.10.21-13','1.10.21-14','1.10.21-15','1.10.21-16','1.10.21-18','1.10.21-19',
#             '1.10.21-2','1.10.21-20','1.10.21-21','1.10.21-22','1.10.21-23','1.10.21-24','1.10.21-25','1.10.21-26',
#             '1.10.21-27','1.10.21-3','1.10.21-4','1.10.21-5','1.10.21-6','1.10.21-7','1.10.21-8','1.10.21-9', 
#             '1.10.22-1','1.10.22-2','1.10.22-3','1.10.22-4','1.10.22-5','1.10.22-6','1.10.22-7','1.10.22-8', 
#             '1.10.22-9','1.10.23-1','1.10.23-10','1.10.23-11','1.10.23-12','1.10.23-13','1.10.23-14','1.10.23-15',
#             '1.10.23-16','1.10.23-17','1.10.23-18','1.10.23-2','1.10.23-3','1.10.23-4','1.10.23-5','1.10.23-6', 
#             '1.10.23-7','1.10.23-8','1.10.23-9','1.10.24-1','1.10.24-10','1.10.24-11','1.10.24-12','1.10.24-13',
#             '1.10.24-14','1.10.24-15','1.10.24-16','1.10.24-17','1.10.24-18','1.10.24-2','1.10.24-3','1.10.24-4', 
#             '1.10.24-5','1.10.24-6','1.10.24-7','1.10.24-8','1.10.24-9','1.10.25-1','1.10.25-10','1.10.25-11',
#             '1.10.25-12','1.10.25-13','1.10.25-14','1.10.25-15','1.10.25-16','1.10.25-17','1.10.25-18','1.10.25-19',
#             '1.10.25-2','1.10.25-20','1.10.25-21','1.10.25-22','1.10.25-3','1.10.25-4','1.10.25-5','1.10.25-6', 
#             '1.10.25-8','1.10.25-9','1.10.26-1','1.10.26-10','1.10.26-11','1.10.26-12','1.10.26-13','1.10.26-14',
#             '1.10.26-15','1.10.26-16','1.10.26-17','1.10.26-18','1.10.26-19','1.10.26-2','1.10.26-20','1.10.26-21',
#             '1.10.26-3','1.10.26-4','1.10.26-5','1.10.26-6','1.10.26-7','1.10.26-8','1.10.26-9','1.10.28-1', 
#             '1.10.28-10','1.10.28-11','1.10.28-12','1.10.28-13','1.10.28-2','1.10.28-3','1.10.28-4','1.10.28-5', 
#             '1.10.28-6','1.10.28-7','1.10.28-8','1.10.28-9','1.10.3-1','1.10.3-10','1.10.3-11','1.10.3-12', 
#             '1.10.3-2','1.10.3-3','1.10.3-4','1.10.3-5','1.10.3-6','1.10.3-7','1.10.3-8','1.10.3-9',  
#             '1.10.30-1','1.10.30-10','1.10.30-11','1.10.30-12','1.10.30-13','1.10.30-14','1.10.30-15','1.10.30-16',
#             '1.10.30-17','1.10.30-18','1.10.30-19','1.10.30-2','1.10.30-20','1.10.30-21','1.10.30-22','1.10.30-3', 
#             '1.10.30-4','1.10.30-5','1.10.30-6','1.10.30-7','1.10.30-8','1.10.30-9','1.10.31-1','1.10.31-10',
#             '1.10.31-11','1.10.31-12','1.10.31-13','1.10.31-2','1.10.31-3','1.10.31-4','1.10.31-5','1.10.31-6', 
#             '1.10.31-7','1.10.31-8','1.10.31-9','1.10.32-1','1.10.32-2','1.10.32-3','1.10.32-4','1.10.32-5', 
#             '1.10.33-1','1.10.33-2','1.10.33-3','1.10.33-4','1.10.34-1','1.10.34-2','1.10.34-3','1.10.35-1', 
#             '1.10.35-10','1.10.35-11','1.10.35-12','1.10.35-13','1.10.35-14','1.10.35-15','1.10.35-16','1.10.35-17',
#             '1.10.35-18','1.10.35-19','1.10.35-2','1.10.35-20','1.10.35-3','1.10.35-4','1.10.35-5','1.10.35-6', 
#             '1.10.35-7','1.10.35-8','1.10.35-9','1.10.36-1','1.10.36-10','1.10.36-11','1.10.36-12','1.10.36-13',
#             '1.10.36-14','1.10.36-15','1.10.36-16','1.10.36-17','1.10.36-18','1.10.36-19','1.10.36-2','1.10.36-20',
#             '1.10.36-21','1.10.36-22','1.10.36-23','1.10.36-24','1.10.36-25','1.10.36-26','1.10.36-27','1.10.36-28',
#             '1.10.36-29','1.10.36-3 ','1.10.36-30','1.10.36-31','1.10.36-32','1.10.36-33','1.10.36-34','1.10.36-35',
#             '1.10.36-36','1.10.36-37','1.10.36-38','1.10.36-39','1.10.36-4','1.10.36-40','1.10.36-41','1.10.36-42',
#             '1.10.36-43','1.10.36-44','1.10.36-45','1.10.36-46','1.10.36-47','1.10.36-5','1.10.36-6','1.10.36-7', 
#             '1.10.36-8','1.10.36-9','1.10.37-1','1.10.37-10','1.10.37-11','1.10.37-12','1.10.37-13','1.10.37-14',
#             '1.10.37-15','1.10.37-16','1.10.37-17','1.10.37-18','1.10.37-19','1.10.37-2','1.10.37-20','1.10.37-21',
#             '1.10.37-22','1.10.37-23','1.10.37-24','1.10.37-25','1.10.37-26','1.10.37-27','1.10.37-28','1.10.37-29',
#             '1.10.37-3','1.10.37-30','1.10.37-31','1.10.37-33','1.10.37-34','1.10.37-35','1.10.37-36','1.10.37-37',
#             '1.10.37-38','1.10.37-39','1.10.37-4','1.10.37-40','1.10.37-41','1.10.37-42','1.10.37-43','1.10.37-44',
#             '1.10.37-45','1.10.37-46','1.10.37-47','1.10.37-48','1.10.37-49','1.10.37-5 ','1.10.37-50','1.10.37-51',
#             '1.10.37-52','1.10.37-53','1.10.37-54','1.10.37-55','1.10.37-56','1.10.37-57','1.10.37-58','1.10.37-59',
#             '1.10.37-6','1.10.37-60','1.10.37-61','1.10.37-62','1.10.37-63','1.10.37-64','1.10.37-65','1.10.37-66',
#             '1.10.37-67','1.10.37-68','1.10.37-69','1.10.37-7','1.10.37-70','1.10.37-71','1.10.37-72','1.10.37-73',
#             '1.10.37-74','1.10.37-75','1.10.37-76','1.10.37-77','1.10.37-78','1.10.37-79','1.10.37-8','1.10.37-80',
#             '1.10.37-81','1.10.37-82','1.10.37-83','1.10.37-84','1.10.37-85','1.10.37-86','1.10.37-87','1.10.37-88',
#             '1.10.37-89','1.10.37-9','1.10.37-90','1.10.37-91','1.10.37-92','1.10.38-1','1.10.38-10','1.10.38-11',
#             '1.10.38-12','1.10.38-13','1.10.38-14','1.10.38-15','1.10.38-16','1.10.38-17','1.10.38-18','1.10.38-19',
#             '1.10.38-2','1.10.38-20','1.10.38-21','1.10.38-22','1.10.38-23','1.10.38-24','1.10.38-25','1.10.38-26',
#             '1.10.38-27','1.10.38-28','1.10.38-29','1.10.38-3','1.10.38-30','1.10.38-31','1.10.38-32','1.10.38-33',
#             '1.10.38-34','1.10.38-35','1.10.38-36','1.10.38-37','1.10.38-38','1.10.38-39','1.10.38-4','1.10.38-40',
#             '1.10.38-41','1.10.38-42','1.10.38-43','1.10.38-44','1.10.38-45','1.10.38-46','1.10.38-47','1.10.38-48',
#             '1.10.38-49','1.10.38-5','1.10.38-50','1.10.38-51','1.10.38-52','1.10.38-53','1.10.38-54','1.10.38-55',
#             '1.10.38-56','1.10.38-57','1.10.38-58','1.10.38-59','1.10.38-6','1.10.38-60','1.10.38-61','1.10.38-62',
#             '1.10.38-63','1.10.38-64','1.10.38-65','1.10.38-66','1.10.38-67','1.10.38-68','1.10.38-69','1.10.38-7', 
#             '1.10.38-70','1.10.38-71','1.10.38-72','1.10.38-73','1.10.38-74','1.10.38-8','1.10.38-9','1.10.5-1',  
#             '1.10.5-2','1.10.5-3','1.10.5-4','1.10.5-5','1.10.5-6','1.10.6-1','1.10.6-2','1.10.6-3',  
#             '1.10.6-4','1.10.6-5','1.10.6-6','1.10.6-7','1.10.6-8','1.10.7-1','1.10.7-10','1.10.7-2',  
#             '1.10.7-3','1.10.7-4','1.10.7-5','1.10.7-6','1.10.7-7','1.10.7-8','1.10.7-9','1.10.8-1',  
#             '1.10.8-2','1.10.8-3','1.10.8-4','1.10.9-1','1.10.9-3','1.10.9-4','1.10.9-5','1.10.9-6')
# 
# 
# oldnames<-c("V1","V2","V3","V4","V5","V6","V7","V8","V9","V10","V11","V12","V13", 
#             "V14","V15","V16","V17","V18","V19","V20","V21","V22","V23","V24","V25","V26", 
#             "V27","V28","V29","V30","V31","V32","V33","V34","V35","V36","V37","V38","V39", 
#             "V40","V41","V42","V43","V44","V45","V46","V47","V48","V49","V50","V51","V52", 
#             "V53","V54","V55","V56","V57","V58","V59","V60","V61","V62","V63","V64","V65", 
#             "V66","V67","V68","V69","V70","V71","V72","V73","V74","V75","V76","V77","V78", 
#             "V79","V80","V81","V82","V83","V84","V85","V86","V87","V88","V89","V90","V91", 
#             "V92","V93","V94","V95","V96","V97","V98","V99","V100","V101","V102","V103","V104",
#             "V105","V106","V107","V108","V109","V110","V111","V112","V113","V114","V115","V116","V117",
#             "V118","V119","V120","V121","V122","V123","V124","V125","V126","V127","V128","V129","V130",
#             "V131","V132","V133","V134","V135","V136","V137","V138","V139","V140","V141","V142","V143",
#             "V144","V145","V146","V147","V148","V149","V150","V151","V152","V153","V154","V155","V156",
#             "V157","V158","V159","V160","V161","V162","V163","V164","V165","V166","V167","V168","V169",
#             "V170","V171","V172","V173","V174","V175","V176","V177","V178","V179","V180","V181","V182",
#             "V183","V184","V185","V186","V187","V188","V189","V190","V191","V192","V193","V194","V195",
#             "V196","V197","V198","V199","V200","V201","V202","V203","V204","V205","V206","V207","V208",
#             "V209","V210","V211","V212","V213","V214","V215","V216","V217","V218","V219","V220","V221",
#             "V222","V223","V224","V225","V226","V227","V228","V229","V230","V231","V232","V233","V234",
#             "V235","V236","V237","V238","V239","V240","V241","V242","V243","V244","V245","V246","V247",
#             "V248","V249","V250","V251","V252","V253","V254","V255","V256","V257","V258","V259","V260",
#             "V261","V262","V263","V264","V265","V266","V267","V268","V269","V270","V271","V272","V273",
#             "V274","V275","V276","V277","V278","V279","V280","V281","V282","V283","V284","V285","V286",
#             "V287","V288","V289","V290","V291","V292","V293","V294","V295","V296","V297","V298","V299",
#             "V300","V301","V302","V303","V304","V305","V306","V307","V308","V309","V310","V311","V312",
#             "V313","V314","V315","V316","V317","V318","V319","V320","V321","V322","V323","V324","V325",
#             "V326","V327","V328","V329","V330","V331","V332","V333","V334","V335","V336","V337","V338",
#             "V339","V340","V341","V342","V343","V344","V345","V346","V347","V348","V349","V350","V351",
#             "V352","V353","V354","V355","V356","V357","V358","V359","V360","V361","V362","V363","V364",
#             "V365","V366","V367","V368","V369","V370","V371","V372","V373","V374","V375","V376","V377",
#             "V378","V379","V380","V381","V382","V383","V384","V385","V386","V387","V388","V389","V390",
#             "V391","V392","V393","V394","V395","V396","V397","V398","V399","V400","V401","V402","V403",
#             "V404","V405","V406","V407","V408","V409","V410","V411","V412","V413","V414","V415","V416",
#             "V417","V418","V419","V420","V421","V422","V423","V424","V425","V426","V427","V428","V429",
#             "V430","V431","V432","V433","V434","V435","V436","V437","V438","V439","V440","V441","V442",
#             "V443","V444","V445","V446","V447","V448","V449","V450","V451","V452","V453","V454","V455",
#             "V456","V457","V458","V459","V460","V461","V462","V463","V464","V465","V466","V467","V468",
#             "V469","V470","V471","V472","V473","V474","V475","V476","V477","V478","V479","V480","V481",
#             "V482","V483","V484","V485","V486","V487","V488","V489","V490","V491","V492","V493","V494",
#             "V495","V496","V497","V498","V499","V500","V501","V502","V503","V504","V505","V506","V507",
#             "V508","V509","V510","V511","V512","V513","V514","V515","V516","V517","V518","V519","V520",
#             "V521","V522","V523","V524","V525","V526","V527","V528","V529","V530","V531","V532","V533",
#             "V534","V535","V536","V537","V538","V539","V540","V541","V542","V543","V544","V545","V546",
#             "V547","V548","V549","V550","V551","V552","V553","V554","V555","V556","V557","V558","V559",
#             "V560","V561","V562","V563","V564","V565","V566","V567","V568","V569","V570","V571","V572",
#             "V573","V574","V575","V576","V577","V578","V579","V580","V581","V582","V583","V584","V585",
#             "V586","V587","V588","V589","V590","V591","V592","V593","V594","V595","V596","V597","V598",
#             "V599","V600","V601","V602","V603","V604","V605","V606","V607","V608","V609","V610","V611",
#             "V612","V613","V614","V615","V616","V617","V618","V619","V620","V621","V622","V623","V624",
#             "V625","V626","V627","V628","V629","V630","V631","V632","V633","V634","V635","V636","V637",
#             "V638","V639","V640","V641","V642","V643","V644","V645","V646","V647","V648","V649","V650",
#             "V651","V652","V653","V654","V655","V656","V657","V658","V659","V660","V661","V662","V663",
#             "V664","V665","V666","V667","V668","V669","V670","V671","V672","V673","V674","V675","V676",
#             "V677","V678","V679","V680","V681","V682","V683","V684","V685","V686","V687","V688","V689",
#             "V690","V691","V692","V693","V694","V695","V696","V697","V698","V699","V700","V701","V702",
#             "V703","V704","V705","V706","V707","V708","V709","V710","V711","V712","V713","V714","V715",
#             "V716","V717","V718","V719","V720","V721","V722","V723","V724","V725","V726","V727","V728",
#             "V729","V730","V731","V732","V733","V734","V735","V736")
# 
# df<-df %>% rename_at(vars(oldnames), ~ newnames)
# write.csv(df,"~/PETM-shiny/PRUEBAS_MODEL/matrix_survey.csv",row.names = FALSE)
# 

# 
# 
# 
